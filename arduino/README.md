# FallHelp ESP32 - Arduino IDE

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå

```
arduino/
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ fallhelp_esp32/
    ‚îî‚îÄ‚îÄ fallhelp_esp32.ino  ‚Üê Firmware ‡∏´‡∏•‡∏±‡∏Å (Captive Portal + WiFi Config)
```

## üîÑ Flow ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Step 1: Upload Firmware                                               ‚îÇ
‚îÇ   1. Upload fallhelp_esp32.ino ‡πÑ‡∏õ‡∏¢‡∏±‡∏á ESP32                            ‚îÇ
‚îÇ   2. ‡πÄ‡∏õ‡∏¥‡∏î Serial Monitor (115200)                                     ‚îÇ
‚îÇ   3. ‡∏î‡∏π Serial Number ‡πÄ‡∏ä‡πà‡∏ô "ESP32-XXXXXXXXXXXX"                       ‚îÇ
‚îÇ   4. ESP32 ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î AP Mode: "FallHelp-XXXXXX" (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô)          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Step 2: Admin ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå                                             ‚îÇ
‚îÇ   Admin Panel ‚Üí Devices ‚Üí Create ‚Üí ‡πÉ‡∏™‡πà Serial Number ‡∏Ç‡∏≠‡∏á ESP32        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Step 3: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ WiFi ‡∏ú‡πà‡∏≤‡∏ô Captive Portal                              ‚îÇ
‚îÇ   1. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° WiFi "FallHelp-XXXXXX" (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô)                    ‚îÇ
‚îÇ   2. Captive Portal ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏õ 192.168.4.1)               ‚îÇ
‚îÇ   3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ WiFi + ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‚Üí ‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å                              ‚îÇ
‚îÇ   4. ESP32 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ (~10‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ) ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à/‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß          ‚îÇ
‚îÇ   5. ESP32 restart ‚Üí ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° WiFi ‚Üí MQTT ‚Üí Online!                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Step 4: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Sensor Events (‡∏à‡∏≥‡∏•‡∏≠‡∏á)                                    ‚îÇ
‚îÇ   ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ô Serial Monitor: fall, hr low/normal/high, status            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîå Hardware

| Component         | Pin             | Description               |
| ----------------- | --------------- | ------------------------- |
| **MPU6050** (I2C) | SDA=21, SCL=22  | Accelerometer + Gyroscope |
| **XD-58C Pulse**  | GPIO34 (Analog) | Heart Rate Sensor         |
| **SOS Button**    | GPIO0           | BOOT button (optional)    |

## üìö Required Libraries

‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ú‡πà‡∏≤‡∏ô Arduino IDE ‚Üí Sketch ‚Üí Include Library ‚Üí Manage Libraries:

1. **PubSubClient** by Nick O'Leary
2. **ArduinoJson** by Benoit Blanchon

> Built-in: WiFi, WebServer, DNSServer, Preferences

## ‚öôÔ∏è Configuration

**Pre-configured:**

| Setting     | Value           |
| ----------- | --------------- |
| MQTT Server | 192.168.1.102   |
| MQTT Port   | 1883            |
| AP SSID     | FallHelp-XXXXXX |
| AP Password | ‡πÑ‡∏°‡πà‡∏°‡∏µ (Open)    |

**‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ú‡πà‡∏≤‡∏ô Captive Portal:**

- WiFi SSID
- WiFi Password

## üéÆ Serial Commands

| Command | Description       |
| ------- | ----------------- |
| `reset` | ‡∏•‡πâ‡∏≤‡∏á WiFi config  |
| `info`  | ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå |

## üì° Captive Portal Endpoints

| Endpoint       | Method | Description                    |
| -------------- | ------ | ------------------------------ |
| `/`            | GET    | ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ WiFi (Mobile UI)   |
| `/wifi-config` | POST   | ‡∏£‡∏±‡∏ö ssid, password (Form POST) |
| `/status`      | GET    | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠              |
| `/reset`       | POST   | ‡∏•‡πâ‡∏≤‡∏á config + restart          |

## ‚ú® Features

- **Open AP** - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏á‡πà‡∏≤‡∏¢
- **Captive Portal** - ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- **Connection Testing** - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö WiFi ‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- **Mobile-style UI** - ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° (Kanit font, ‡∏™‡∏µ FallHelp)
- **MQTT Last Will** - ‡πÅ‡∏à‡πâ‡∏á Offline ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠ disconnect

## üöÄ Quick Start

1. ‡πÄ‡∏õ‡∏¥‡∏î Arduino IDE
2. File ‚Üí Open ‚Üí `fallhelp_esp32.ino`
3. Tools ‚Üí Board ‚Üí ESP32 Dev Module
4. Tools ‚Üí Port ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å COM port
5. Upload (‚Üí)
6. ‡πÄ‡∏õ‡∏¥‡∏î Serial Monitor (115200) ‚Üí ‡∏î‡∏π Serial Number
7. Admin ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏î‡πâ‡∏ß‡∏¢ Serial Number
8. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° WiFi "FallHelp-XXXXXX" ‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ú‡πà‡∏≤‡∏ô Captive Portal

---

**Last Updated:** December 14, 2025
**Status:** Firmware v5.0 - Captive Portal Ready
